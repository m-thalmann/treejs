/**
 * TreeJS is a JavaScript library for displaying TreeViews
 * on the web.
 *
 * @author Matthias Thalmann
 * @copyright Matthias Thalmann
 */
const TreeUtil={default_leaf_icon:"<span>&#128441;</span>",default_parent_icon:"<span>&#128449;</span>",default_open_icon:"<span>&#9698;</span>",default_close_icon:"<span>&#9654;</span>",isDOM(e){try{return e instanceof HTMLElement}catch{return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}},getProperty:(e,t,n)=>void 0===e[t]?n:e[t],expandNode(e){e.setExpanded(!0),e.isLeaf()||e.getChildren().forEach((e=>{TreeUtil.expandNode(e)}))},collapseNode(e){e.setExpanded(!1),e.isLeaf()||e.getChildren().forEach((e=>{TreeUtil.collapseNode(e)}))},getSelectedNodesForNode(e){if(!(e instanceof TreeNode))throw new Error("Parameter 1 must be of type TreeNode");const t=new Array;return e.isSelected()&&t.push(e),e.getChildren().forEach((e=>{e.isSelected()&&-1===t.indexOf(e)&&t.push(e),e.isLeaf()||TreeUtil.getSelectedNodesForNode(e).forEach((e=>{-1===t.indexOf(e)&&t.push(e)}))})),t}},TreeConfig={leaf_icon:TreeUtil.default_leaf_icon,parent_icon:TreeUtil.default_parent_icon,open_icon:TreeUtil.default_open_icon,close_icon:TreeUtil.default_close_icon,context_menu:void 0};function TreeNode(e,t){const n=new Array,o=new Array;let i=!0,r=!0,s=!1;if(e){if("string"!=typeof e&&"function"!=typeof e.toString)throw new Error("Parameter 1 must be of type String or Object, where it must have the function toString()")}else e="";t&&"object"==typeof t?(i=TreeUtil.getProperty(t,"expanded",!0),r=TreeUtil.getProperty(t,"enabled",!0),s=TreeUtil.getProperty(t,"selected",!1)):t={},this.addChild=function(e){if(TreeUtil.getProperty(t,"allowsChildren",!0)){if(!(e instanceof TreeNode))throw new Error("Parameter 1 must be of type TreeNode");n.push(e),Object.defineProperty(e,"parent",{value:this,writable:!1,enumerable:!0,configurable:!0})}else console.warn("Option allowsChildren is set to false, no child added")},this.removeChildPos=function(e){void 0!==n[e]&&void 0!==n[e]&&n.splice(e,1)},this.removeChild=function(e){if(!(e instanceof TreeNode))throw new Error("Parameter 1 must be of type TreeNode");this.removeChildPos(this.getIndexOfChild(e))},this.getChildren=function(){return n},this.getChildCount=function(){return n.length},this.getIndexOfChild=function(e){for(let t=0;t<n.length;t++)if(n[t].equals(e))return t;return-1},this.getRoot=function(){let e=this;for(;void 0!==e.parent;)e=e.parent;return e},this.setUserObject=function(t){if("string"!=typeof t||"function"!=typeof t.toString)throw new Error("Parameter 1 must be of type String or Object, where it must have the function toString()");e=t},this.getUserObject=function(){return e},this.setOptions=function(e){"object"==typeof e&&(t=e)},this.changeOption=function(e,n){t[e]=n},this.getOptions=function(){return t},this.isLeaf=function(){return 0===n.length},this.setExpanded=function(e){if(!this.isLeaf()&&"boolean"==typeof e){if(i===e)return;i=e,e?this.on("expand")(this):this.on("collapse")(this),this.on("toggle_expanded")(this)}},this.toggleExpanded=function(){i?this.setExpanded(!1):this.setExpanded(!0)},this.isExpanded=function(){return!!this.isLeaf()||i},this.setEnabled=function(e){if("boolean"==typeof e){if(r==e)return;r=e,e?this.on("enable")(this):this.on("disable")(this),this.on("toggle_enabled")(this)}},this.toggleEnabled=function(){r?this.setEnabled(!1):this.setEnabled(!0)},this.isEnabled=function(){return r},this.setSelected=function(e){"boolean"==typeof e&&s!==e&&(s=e,e?this.on("select")(this):this.on("deselect")(this),this.on("toggle_selected")(this))},this.toggleSelected=function(){s?this.setSelected(!1):this.setSelected(!0)},this.isSelected=function(){return s},this.open=function(){this.isLeaf()||this.on("open")(this)},this.on=function(e,t){if(void 0===t)return"function"!=typeof o[e]?function(){}:o[e];if("function"!=typeof t)throw new Error("Argument 2 must be of type function");o[e]=t},this.getListener=function(e){return o[e]},this.equals=function(t){return t instanceof TreeNode&&t.getUserObject()===e},this.toString=function(){return"string"==typeof e?e:e.toString()}}function TreeView(e,t,n){const o=this;if(void 0===e)throw new Error("Parameter 1 must be set (root)");if(!(e instanceof TreeNode))throw new Error("Parameter 1 must be of type TreeNode");if(t){if(!TreeUtil.isDOM(t)&&((t=document.querySelector(t))instanceof Array&&(t=t[0]),!TreeUtil.isDOM(t)))throw new Error("Parameter 2 must be either DOM-Object or CSS-QuerySelector (#, .)")}else t=null;function i(e){const t=document.createElement("li"),r=document.createElement("span");if(r.className="tj_description",r.tj_node=e,e.isEnabled()||(t.setAttribute("disabled",""),e.setExpanded(!1),e.setSelected(!1)),e.isSelected()&&r.classList.add("selected"),r.addEventListener("click",(e=>{let t=e.target;for(;void 0===t.tj_node||t.classList.contains("tj_container");)t=t.parentElement;const n=t.tj_node;if(void 0!==n&&n.isEnabled())if(!1===e.ctrlKey&&(n.isLeaf()?n.open():(n.toggleExpanded(),o.reload()),n.on("click")(e,n)),!0===e.ctrlKey)n.toggleSelected(),o.reload();else{const e=n.getRoot();e instanceof TreeNode&&TreeUtil.getSelectedNodesForNode(e).forEach((e=>{e.setSelected(!1)})),n.setSelected(!0),o.reload()}})),r.addEventListener("contextmenu",(e=>{let t=e.target;for(;void 0===t.tj_node||t.classList.contains("tj_container");)t=t.parentElement;const n=t.tj_node;void 0!==n&&(void 0!==n.getListener("contextmenu")?(n.on("contextmenu")(e,n),e.preventDefault()):"function"==typeof TreeConfig.context_menu&&(TreeConfig.context_menu(e,n),e.preventDefault()))})),e.isLeaf()&&!TreeUtil.getProperty(e.getOptions(),"forceParent",!1)){let o="",i=TreeUtil.getProperty(e.getOptions(),"icon","");""!==i||""!=(i=TreeUtil.getProperty(n,"leaf_icon",""))?o+=`<span class="tj_icon">${i}</span>`:o+=`<span class="tj_icon">${TreeConfig.leaf_icon}</span>`,r.innerHTML=`${o+e.toString()}</span>`,r.classList.add("tj_leaf"),t.appendChild(r)}else{let o="";e.isExpanded()?o+=`<span class="tj_mod_icon">${TreeConfig.open_icon}</span>`:o+=`<span class="tj_mod_icon">${TreeConfig.close_icon}</span>`;const s=TreeUtil.getProperty(e.getOptions(),"icon","");if(""!==s||""!=(s=TreeUtil.getProperty(n,"parent_icon",""))?o+=`<span class="tj_icon">${s}</span>`:o+=`<span class="tj_icon">${TreeConfig.parent_icon}</span>`,r.innerHTML=`${o+e.toString()}</span>`,t.appendChild(r),e.isExpanded()){const n=document.createElement("ul");e.getChildren().forEach((e=>{n.appendChild(i(e))})),t.appendChild(n)}}return t}n&&"object"==typeof n||(n={}),this.setRoot=function(t){e instanceof TreeNode&&(e=t)},this.getRoot=function(){return e},this.expandAllNodes=function(){e.setExpanded(!0),e.getChildren().forEach((e=>{TreeUtil.expandNode(e)}))},this.expandPath=function(e){if(!(e instanceof TreePath))throw new Error("Parameter 1 must be of type TreePath");e.getPath().forEach((e=>{e.setExpanded(!0)}))},this.collapseAllNodes=function(){e.setExpanded(!1),e.getChildren().forEach((e=>{TreeUtil.collapseNode(e)}))},this.setContainer=function(e){if(TreeUtil.isDOM(e))t=e;else if((e=document.querySelector(e))instanceof Array&&(e=e[0]),!TreeUtil.isDOM(e))throw new Error("Parameter 1 must be either DOM-Object or CSS-QuerySelector (#, .)")},this.getContainer=function(){return t},this.setOptions=function(e){"object"==typeof e&&(n=e)},this.changeOption=function(e,t){n[e]=t},this.getOptions=function(){return n},this.getSelectedNodes=function(){return TreeUtil.getSelectedNodesForNode(e)},this.reload=function(){if(null===t)return void console.warn("No container specified");t.classList.add("tj_container");const o=document.createElement("ul");TreeUtil.getProperty(n,"show_root",!0)?o.appendChild(i(e)):e.getChildren().forEach((e=>{o.appendChild(i(e))})),t.innerHTML="",t.appendChild(o)},void 0!==t&&this.reload()}function TreePath(e,t){let n=new Array;this.setPath=function(e,t){for(n=new Array;void 0!==t&&!t.equals(e);)n.push(t),t=t.parent;if(!t.equals(e))throw n=new Array,new Error("Node is not contained in the tree of root");return n.push(e),n=n.reverse(),n},this.getPath=function(){return n},this.toString=function(){return n.join(" - ")},e instanceof TreeNode&&t instanceof TreeNode&&this.setPath(e,t)}function test(){return console.log("Test function executed"),"Test completed"}